---
title: "Hjalmar_oct2023"
author: "Hjalmar Ã–hman"
date: "2024-10-22"
output: pdf_document
---

## 1
```{r}
library(bnlearn)
both = model2network("[U][Ch|U][Ah|Ch][Bh|Ch][Dh|Ah:Bh][C|U][A|C][B|C][D|A:B]")
graphviz.plot(both)

U = matrix(c(0.5, 0.5), nrow = 1, ncol = 2)
dim(U) = c(2)
dimnames(U) = list("U" = c("U0", "U1"))

C = matrix(c(0.9,0.1,0.1,0.9), nrow = 2, ncol=2)
dim(C) = c(2,2)
dimnames(C) = list("C" = c("C0", "C1"), "U" = c("U0","U1"))

A = matrix(c(1,0,0.2,0.8), nrow = 2, ncol = 2)
dim(A) = c(2,2)
dimnames(A) = list("A" = c("A0", "A1"), "C" = c("C0", "C1"))

B = matrix(c(1,0,0.2,0.8), nrow = 2, ncol = 2)
dim(B) = c(2,2)
dimnames(B) = list("B" = c("B0", "B1"), "C" = c("C0", "C1"))

D = matrix(c(0.9, #000
             0.1, #100
             0,   #010
             1,   #110
             0,   #001
             1,   #101
             0,   #011
             1),  #111
           nrow = 2, ncol = 4)
dim(D) = c(2,2,2)
dimnames(D) = list("D"=c("D0", "D1"), "A" = c("A0", "A1"), "B" = c("B0", "B1"))

Ch = matrix(c(0.9,0.1,0.1,0.9), nrow = 2, ncol=2)
dim(Ch) = c(2,2)
dimnames(Ch) = list("Ch" = c("C0", "C1"), "U" = c("U0","U1"))

Ah = matrix(c(1,0,0.2,0.8), nrow = 2, ncol = 2)
dim(Ah) = c(2,2)
dimnames(Ah) = list("Ah" = c("A0", "A1"), "Ch" = c("C0", "C1"))

Bh = matrix(c(1,0,0.2,0.8), nrow = 2, ncol = 2)
dim(Bh) = c(2,2)
dimnames(Bh) = list("Bh" = c("B0", "B1"), "Ch" = c("C0", "C1"))

Dh = matrix(c(0.9, #000
             0.1, #100
             0,   #010
             1,   #110
             0,   #001
             1,   #101
             0,   #011
             1),  #111
           nrow = 2, ncol = 4)
dim(Dh) = c(2,2,2)
dimnames(Dh) = list("Dh"=c("D0", "D1"), "Ah" = c("A0", "A1"), "Bh" = c("B0", "B1"))

fit = custom.fit(both, list(U = U, Ch = Ch, Ah = Ah, Bh = Bh, Dh = Dh, C = C, A = A, B = B, D = D))
fitcom = compile(as.grain(fit))

evidence = setEvidence(fitcom, evidence = list(D = "1", Ah = "0"))
querygrain(evidence, "Dh")
```
